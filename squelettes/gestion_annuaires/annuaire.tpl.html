<p><a href="<?php $url_retour = clone($base_url); 
					$url_retour->setVariableRequete('m','liste_annu'); 
					echo $url_retour; ?>"> Retour à la liste des annuaires </a>	
</p>					

<h2>Détail de l'annuaire <?=$annuaire['informations']['aa_nom'] ?></h2>
<p><?=$annuaire['informations']['aa_description'] ?></p>

<h3> Informations </h3>
<table class="liste">
	<tr>
		<th>Identifiant d'annuaire</th>
		<th>Nom</th>
		<th>Description</th>
		<th>Code</th>
	</tr>
	<tr>
		<td><?=$annuaire['informations']['aa_id_annuaire'] ?></td>
		<td><?=$annuaire['informations']['aa_nom'] ?></td>
		<td><?=$annuaire['informations']['aa_description'] ?></td>
		<td><?=$annuaire['informations']['aa_code'] ?></td>
	</tr>
</table>

<hr />

<h3> Colonnes </h3>
<table class="liste">
	<tr>
		<th>Nom du champ</th>
		<th>Type</th>
		<th>Null</th>
		<th>Clé</th>
		<th>Défaut</th>
		<th>Extra</th>
	</tr>
	<?php foreach ($annuaire['colonnes'] as $colonne) : ?>
	<tr>
		<td><?=$colonne['Field'] ?></td>
		<td><?=$colonne['Type'] ?></td>
		<td><?=$colonne['Null'] ?></td>
		<td><?=$colonne['Key'] ?></td>
		<td><?=$colonne['Default'] ?></td>
		<td><?=$colonne['Extra'] ?></td>
	</tr>
	<?php endforeach; ?>
</table>

<hr />

<h3> Metadonnées </h3>

<p> <a href="<?php $url_ajout_metadonnee = clone($base_url); 
				$url_ajout_metadonnee->setVariableRequete('m','metadonnee_formulaire_ajout'); 
				$url_ajout_metadonnee->setVariableRequete('amc_ce_annuaire',$annuaire['informations']['aa_id_annuaire']); 
				echo $url_ajout_metadonnee; ?>"> Ajout d'un nouveau champ </a>
</p>

<table class="liste">
	<tr>
		<th>Nom du champ</th>
		<th>Type</th>
		<th>Abreviation</th>
		<th>Description</th>
		<th>Longueur</th>
		<th></th>
		<th></th>
	</tr>
	<?php foreach ($metadonnees as $metacolonne) : ?>
	<tr>
		<td><?=$metacolonne['amc_nom'] ?></td>
		<td><?=$metacolonne['amc_ce_nom_type_affichage'] ?></td>
		<td><?=$metacolonne['amc_abreviation'] ?></td>
		<td><?=$metacolonne['amc_description'] ?></td>
		<td><?=$metacolonne['amc_longueur'] ?></td>
		<td><a href="<?php $url_modif_metadonnee = clone($base_url); 
				$url_modif_metadonnee->setVariableRequete('m','metadonnee_formulaire_modification'); 
				$url_modif_metadonnee->setVariableRequete('amc_id_champ',$metacolonne['amc_id_champ']); 
				echo $url_modif_metadonnee; ?>"> <img class="icone" src="<?=$base_url_styles ?>squelettes/images/modification.png"/> </a>
		</td>
		<td><a href="<?php $url_supp_metadonnee = clone($base_url); 
				$url_supp_metadonnee->setVariableRequete('m','metadonnee_suppression'); 
				$url_supp_metadonnee->setVariableRequete('amc_id_champ',$metacolonne['amc_id_champ']); 
				$url_supp_metadonnee->setVariableRequete('amc_ce_annuaire',$annuaire['informations']['aa_id_annuaire']); 
				echo $url_supp_metadonnee; ?>"> <img class="icone" src="<?=$base_url_styles ?>squelettes/images/suppression.png"/> </a></td>
			
	</tr>
	<?php endforeach; ?>
</table>

<h3> Mappages de champs </h3>

<p> <a href="<?php $url_ajout_mappage = clone($base_url); 
				$url_ajout_mappage->setVariableRequete('m','mappage_formulaire_ajout'); 
				$url_ajout_mappage->setVariableRequete('id_annuaire',$annuaire['informations']['aa_id_annuaire']); 
				echo $url_ajout_mappage; ?>"> Ajout d'un nouveau mappage de champ </a>
</p>

<table class="liste">
	<tr>
		<th>Nom du champ dans l'annuaire</th>
		<th>Type</th>
		<th>Nom du champ de métadonnées associé</th>
		<th></th>
		<th></th>
	</tr>
	<?php foreach ($champs_mappage[0] as $role => $champ_mappage) : ?>
	<tr>
		<td><?=$champ_mappage ?></td>
		<td><?=$role ?></td>
		<td><?php if(isset($champs_mappage[1][$role])) echo $metadonnees[$champs_mappage[1][$role]]['amc_nom']; ?></td>
		<td><a href=""> <img class="icone" src="<?=$base_url_styles ?>squelettes/images/modification.png"/> </a>
		</td>
		<td><a href=""> <img class="icone" src="<?=$base_url_styles ?>squelettes/images/suppression.png"/> </a></td>
			
	</tr>
	<?php endforeach; ?>
</table>


<?php if (isset($erreurs['supp'])): ?>
<span class="symbole_obligatoire"> <?=$erreurs['supp'];?> </span>
<?php endif; ?>